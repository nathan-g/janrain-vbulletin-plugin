<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
Place this link in your navbar in the nouser <ul>:
<li><a class='iframe janrain_signin_link' href='https://{vb:raw vboptions.janrain_capture_captureaddr}/oauth/signin?response_type=code&redirect_uri={vb:raw vboptions.bburl}%2F&client_id={vb:raw vboptions.janrain_capture_clientid}&xd_receiver={vb:raw vboptions.bburl}%2Fpackages%2Fjanrain_capture%2Fxdcomm.html'>Register / Sign In</a></li>
-->
<product productid="janrain_capture" active="1">
	<title>Janrain Capture</title>
	<description>Janrain Capture</description>
	<version>0.0.3</version>
	<url>http://www.janrain.com</url>
	<versioncheckurl />
	<dependencies>
		<dependency dependencytype="php" minversion="5" maxversion="" />
		<dependency dependencytype="vbulletin" minversion="4.0.1" maxversion="" />
	</dependencies>
	<codes>
	</codes>
	<templates>
		<template name="janrain_capture_scripts" templatetype="template" username="Janrain Capture" version="0.0.2"><![CDATA[
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
<script src="{vb:raw vboptions.bburl}/packages/janrain_capture/fancybox/jquery.fancybox-1.3.3.pack.js"></script>
<script src="{vb:raw vboptions.bburl}/packages/janrain_capture/json2.js"></script>
<vb:literal>
<script type="text/javascript">
   jQuery(document).ready(function($) {
       $('.janrain_signin_link').fancybox({
          padding: 0,
          scrolling: 'no',
          autoScale: true,
          width: 666,
          autoDimensions: false
       });
       // $('a[rel*=lightbox]').fancybox()
   });
CAPTURE = {
  resize: function(jargs) {
    var args = JSON.parse(jargs);

    jQuery("#fancybox-inner").css({'width': args.w + 'px', 'height': args.h + 'px'});
    jQuery("#fancybox-wrap").css({'width': args.w + 'px', 'height': args.h + 'px'});
    jQuery("#fancybox-content").css({ "height": args.h + 'px', "width": args.w + 'px'});
    jQuery("#fancybox-frame").css({'width': args.w + 'px', 'height': args.h + 'px'});

    jQuery.fancybox.resize();
    jQuery.fancybox.center();
  }
};
</script>
</vb:literal>
<vb:if condition="$show['member']">
<script type="text/javascript">
function mylogout() {
  JANRAIN.SSO.CAPTURE.logout({
      sso_server: 'https://{vb:raw vboptions.janrain_capture_sso}',
      logout_uri: '{vb:raw vboptions.bburl}/login.php?{vb:raw session.sessionurl}do=logout&logouthash={vb:raw bbuserinfo.logouthash}'
  });
};
</script>
<vb:else />
<vb:if condition="$vbulletin->options['janrain_capture_sso']">
<script src="https://{vb:raw vboptions.janrain_capture_sso}/sso.js" type="text/javascript"></script>
<script type="text/javascript">
JANRAIN.SSO.CAPTURE.check_login({
    sso_server: 'https://{vb:raw vboptions.janrain_capture_sso}',
    client_id: '{vb:raw vboptions.janrain_capture_clientid}',
    redirect_uri: '{vb:raw vboptions.bburl}/',
    logout_uri: '{vb:raw vboptions.bburl}/login.php?{vb:raw session.sessionurl}do=logout&logouthash={vb:raw bbuserinfo.logouthash}',
    xd_receiver: '{vb:raw vboptions.bburl}/packages/janrain_capture/xdcomm.html'
});
</script>
</vb:if>
</vb:if>
		]]></template>
		<template name="janrain_capture_styles" templatetype="template" username="Janrain Capture" version="9.0.1"><![CDATA[
<link rel="stylesheet" href="{vb:raw vboptions.bburl}/packages/janrain_capture/fancybox/jquery.fancybox-1.3.3.css" />
		]]></template>
	</templates>
	<stylevardfns>
	</stylevardfns>
	<stylevars>
	</stylevars>
	<plugins>
		<plugin active="1" executionorder="5">
			<title>Janrain Capture Dependency Loader</title>
			<hookname>parse_templates</hookname>
			<phpcode><![CDATA[if ($vbulletin->options['janrain_capture_enable']) {
	$templater = vB_Template::create('janrain_capture_scripts');
	$templater->register_page_templates();
	$template_hook['footer_javascript'] .= $templater->render();
	$templater2 = vB_Template::create('janrain_capture_styles');
	$templater2->register_page_templates();
	$template_hook['headinclude_css'] .= $templater2->render();
}]]></phpcode>
		</plugin>
		<plugin active="1" executionorder="1">
			<title>Janrain Capture Callback</title>
			<hookname>global_start</hookname>
			<phpcode><![CDATA[if ($vbulletin->options['janrain_capture_enable'] && isset($_GET['code'])) {
	require_once(DIR . '/packages/janrain_capture/include.php');
	capture_user_authenticate();

	if (isset($_GET['origin'])) {
		header("Location: " . urldecode($_GET['origin']));
	} else {
		echo '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<body>
<script type="text/javascript">
  if (window.location != window.parent.location)
    window.parent.location.reload();
</script>
</body>
</html>';
	}
}]]></phpcode>
		</plugin>
	</plugins>
	<phrases>
		<phrasetype name="vBulletin Settings" fieldname="vbsettings">
			<phrase name="settinggroup_janrain_capture" date="1294982387" username="Janrain Capture" version="0.0.1"><![CDATA[Janrain Capture Options]]></phrase>
			<phrase name="setting_janrain_capture_enable_desc"><![CDATA[Enable Janrain Capture.]]></phrase>
			<phrase name="setting_janrain_capture_enable_title"><![CDATA[Enable]]></phrase>
			<phrase name="setting_janrain_capture_clientid_desc"><![CDATA[Your Janrain Capture Client ID.]]></phrase>
			<phrase name="setting_janrain_capture_clientid_title"><![CDATA[Client ID]]></phrase>
			<phrase name="setting_janrain_capture_clientsecret_desc"><![CDATA[Your Janrain Capture Client Secret.]]></phrase>
			<phrase name="setting_janrain_capture_clientsecret_title"><![CDATA[Client Secret]]></phrase>
			<phrase name="setting_janrain_capture_captureaddr_desc"><![CDATA[Your Janrain Capture Application URL. (e.g. myapp.janraincapture.com)]]></phrase>
			<phrase name="setting_janrain_capture_captureaddr_title"><![CDATA[Capture URL]]></phrase>
			<phrase name="setting_janrain_capture_sso_desc"><![CDATA[Your Janrain Capture SSO URL. (e.g. myapp.janrainsso.com)]]></phrase>
			<phrase name="setting_janrain_capture_sso_title"><![CDATA[Janrain SSO URL]]></phrase>
			<phrase name="setting_janrain_capture_uuid_desc"><![CDATA[The column name of the User Profile Field used to store the Capture UUID]]></phrase>
			<phrase name="setting_janrain_capture_uuid_title"><![CDATA[Capture UUID Field]]></phrase>
		</phrasetype>
	</phrases>
	<options>
		<settinggroup name="janrain_capture" displayorder="9990" product="janrain_capture">
			<setting varname="janrain_capture_enable" displayorder="10">
				<datatype>boolean</datatype>
				<optioncode>yesno</optioncode>
				<defaultvalue>0</defaultvalue>
			</setting>
			<setting varname="janrain_capture_clientid" displayorder="20">
				<datatype>free</datatype>
				<defaultvalue></defaultvalue>
			</setting>
			<setting varname="janrain_capture_clientsecret" displayorder="30">
				<datatype>free</datatype>
				<defaultvalue></defaultvalue>
			</setting>
			<setting varname="janrain_capture_captureaddr" displayorder="40">
				<datatype>free</datatype>
				<defaultvalue></defaultvalue>
			</setting>
			<setting varname="janrain_capture_sso" displayorder="50">
				<datatype>free</datatype>
				<defaultvalue></defaultvalue>
			</setting>
			<setting varname="janrain_capture_uuid" displayorder="60">
				<datatype>free</datatype>
				<defaultvalue></defaultvalue>
			</setting>
		</settinggroup>
	</options>
	<helptopics>
	</helptopics>
	<cronentries>
	</cronentries>
	<faqentries>
	</faqentries>
</product>
